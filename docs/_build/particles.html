
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Particle Species &#8212; PyPIC3D 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Laser Pulses" href="lasers.html" />
    <link rel="prev" title="Yee Grid" href="yee.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="particle-species">
<h1>Particle Species<a class="headerlink" href="#particle-species" title="Permalink to this headline">¶</a></h1>
<p>In PyPIC3D, particle species are used to represent different types of particles in the simulation. Each species can have its own unique properties such as mass, charge, and initial conditions. This allows for the simulation of complex systems with multiple interacting particle types.</p>
<section id="key-properties">
<h2>Key Properties<a class="headerlink" href="#key-properties" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Mass</strong>: The mass of the particle species.</p></li>
<li><p><strong>Charge</strong>: The electric charge of the particle species.</p></li>
<li><p><strong>Initial Conditions</strong>: The initial position and velocity of the particles in the species.</p></li>
</ul>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To define a particle species in PyPIC3D, you typically create an instance of the <cite>ParticleSpecies</cite> class in the configuration file. Here is an example of how you might define a particle species in the configuration file:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[particle1]</span><span class="w"></span>
<span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;electrons&quot;</span><span class="w"></span>
<span class="n">N_particles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30000</span><span class="w"></span>
<span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="n">charge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="mf">.602e-19</span><span class="w"></span>
<span class="n">mass</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">9.1093837e-31</span><span class="w"></span>
<span class="n">temperature</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">293000</span><span class="w"></span>
</pre></div>
</div>
<p>To incorporate particle species in a simulation, the following parameters must be set for a particle species in the configuration file:</p>
<ul class="simple">
<li><p><cite>name</cite>: The name of the particle species.</p></li>
<li><p><cite>N_particles</cite>: The number of particles in the species.</p></li>
<li><p><cite>weight</cite>: The weight of the particles.</p></li>
<li><p><cite>charge</cite>: The charge of the particles.</p></li>
<li><p><cite>mass</cite>: The mass of the particles.</p></li>
<li><p><cite>temperature</cite>: The temperature of the particles.</p></li>
</ul>
<p>Optional Parameters:</p>
<ul class="simple">
<li><p><cite>initial_x</cite>: Path to <a href="#id1"><span class="problematic" id="id2">*</span></a>.npy file containing the initial x position of the particles.</p></li>
<li><p><cite>initial_y</cite>: Path to <a href="#id3"><span class="problematic" id="id4">*</span></a>.npy file containing the initial y position of the particles.</p></li>
<li><p><cite>initial_z</cite>: Path to <a href="#id5"><span class="problematic" id="id6">*</span></a>.npy file containing the initial z position of the particles.</p></li>
<li><p><cite>initial_vx</cite>: Path to <a href="#id7"><span class="problematic" id="id8">*</span></a>.npy file containing the initial x velocity of the particles.</p></li>
<li><p><cite>initial_vy</cite>: Path to <a href="#id9"><span class="problematic" id="id10">*</span></a>.npy file containing the initial y velocity of the particles.</p></li>
<li><p><cite>initial_vz</cite>: Path to <a href="#id11"><span class="problematic" id="id12">*</span></a>.npy file containing the initial z velocity of the particles.</p></li>
<li><p><cite>update_pos</cite>: Whether to update the position of the particles.</p></li>
<li><p><cite>update_v</cite>: Whether to update the velocity of the particles.</p></li>
<li><p><cite>update_vx</cite>: Whether to update the x velocity of the particles.</p></li>
<li><p><cite>update_vy</cite>: Whether to update the y velocity of the particles.</p></li>
<li><p><cite>update_vz</cite>: Whether to update the z velocity of the particles.</p></li>
<li><p><cite>update_x</cite>: Whether to update the x position of the particles.</p></li>
<li><p><cite>update_y</cite>: Whether to update the y position of the particles.</p></li>
<li><p><cite>update_z</cite>: Whether to update the z position of the particles.</p></li>
</ul>
</section>
<section id="particle-species-initialization">
<h2>Particle Species Initialization<a class="headerlink" href="#particle-species-initialization" title="Permalink to this headline">¶</a></h2>
<p>The position of the particles is initialized using a uniform distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_particles</span><span class="p">,),</span> <span class="n">minval</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key2</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_particles</span><span class="p">,),</span> <span class="n">minval</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key3</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_particles</span><span class="p">,),</span> <span class="n">minval</span><span class="o">=</span><span class="n">zmin</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">zmax</span><span class="p">)</span>
<span class="c1"># Generate random numbers from a uniform distribution</span>
<span class="c1"># to initialize the position of the particles</span>
</pre></div>
</div>
<p>The velocity of the particles is initialized using a Maxwell-Boltzmann distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">std</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">mass</span>
<span class="n">v_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">N_particles</span><span class="p">)</span>
<span class="n">v_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">N_particles</span><span class="p">)</span>
<span class="n">v_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">N_particles</span><span class="p">)</span>
<span class="c1"># initialize the particles such that the magnitude of the velocity follows a maxwell boltzmann distribution</span>
</pre></div>
</div>
</section>
</section>
<section id="bounded-particles">
<h1>Bounded Particles<a class="headerlink" href="#bounded-particles" title="Permalink to this headline">¶</a></h1>
<p>Bounded Particles can be used to simulate linearly dispersive materials more accurately than a bulk permittivity model. A damped harmonic
oscillator is used to model bounded particles such as semimetals by simulating a free electron gas with a uniform background
of ions. This is done by added additional force terms to the Boris Push algorithm.</p>
<section id="incorporating-bounded-particles-in-a-simulation">
<h2>Incorporating Bounded Particles in a Simulation<a class="headerlink" href="#incorporating-bounded-particles-in-a-simulation" title="Permalink to this headline">¶</a></h2>
<p>To incorporate bounded particles in a simulation, the following parameters must be set for a particle species in the configuration file:</p>
<ul class="simple">
<li><p><cite>name</cite>: The name of the particle species.</p></li>
<li><p><cite>N_particles</cite>: The number of particles in the species.</p></li>
<li><p><cite>weight</cite>: The weight of the particles.</p></li>
<li><p><cite>charge</cite>: The charge of the particles.</p></li>
<li><p><cite>mass</cite>: The mass of the particles.</p></li>
<li><p><cite>temperature</cite>: The temperature of the particles.</p></li>
<li><p><cite>bounded = true</cite>: This parameter must be set to true to enable bounded particles.</p></li>
<li><p><cite>fermi_energy</cite>: The Fermi energy of the bounded particles.</p></li>
<li><p><cite>xmin</cite>, <cite>xmax</cite>, <cite>ymin</cite>, <cite>ymax</cite>, <cite>zmin</cite>, <cite>zmax</cite>: The minimum and maximum values of the bounded particles in the x, y, and z directions.</p></li>
<li><p><cite>w</cite>: The spring constant for the bounded particles in the x, y, and z directions.</p></li>
<li><p><cite>g</cite>: The damping factor for the bounded particles in the x, y, and z directions.</p></li>
</ul>
<p>Optional Parameters:</p>
<ul class="simple">
<li><p><cite>initial_x</cite>: Path to <a href="#id13"><span class="problematic" id="id14">*</span></a>.npy file containing the initial x position of the particles.</p></li>
<li><p><cite>initial_y</cite>: Path to <a href="#id15"><span class="problematic" id="id16">*</span></a>.npy file containing the initial y position of the particles.</p></li>
<li><p><cite>initial_z</cite>: Path to <a href="#id17"><span class="problematic" id="id18">*</span></a>.npy file containing the initial z position of the particles.</p></li>
<li><p><cite>initial_vx</cite>: Path to <a href="#id19"><span class="problematic" id="id20">*</span></a>.npy file containing the initial x velocity of the particles.</p></li>
<li><p><cite>initial_vy</cite>: Path to <a href="#id21"><span class="problematic" id="id22">*</span></a>.npy file containing the initial y velocity of the particles.</p></li>
<li><p><cite>initial_vz</cite>: Path to <a href="#id23"><span class="problematic" id="id24">*</span></a>.npy file containing the initial z velocity of the particles.</p></li>
<li><p><cite>update_pos</cite>: Whether to update the position of the particles.</p></li>
<li><p><cite>update_v</cite>: Whether to update the velocity of the particles.</p></li>
<li><p><cite>update_vx</cite>: Whether to update the x velocity of the particles.</p></li>
<li><p><cite>update_vy</cite>: Whether to update the y velocity of the particles.</p></li>
<li><p><cite>update_vz</cite>: Whether to update the z velocity of the particles.</p></li>
<li><p><cite>update_x</cite>: Whether to update the x position of the particles.</p></li>
<li><p><cite>update_y</cite>: Whether to update the y position of the particles.</p></li>
<li><p><cite>update_z</cite>: Whether to update the z position of the particles.</p></li>
</ul>
</section>
<section id="bounded-particle-initialization">
<h2>Bounded Particle Initialization<a class="headerlink" href="#bounded-particle-initialization" title="Permalink to this headline">¶</a></h2>
<p>The velocity of the bounded particles are initialized using a Fermi-Dirac distribution.</p>
<p>The energy of the particles is sampled from a Fermi-Dirac distribution and used to calculate the magnitude of the velocity using the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uniformdist</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">key1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N_particles</span><span class="p">,),</span> <span class="n">minval</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Generate random numbers from a uniform distribution</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">fermi_energy</span> <span class="o">-</span> <span class="n">kb</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">uniformdist</span><span class="p">)</span>
<span class="c1"># Sample the energy of the particles from the fermi dirac distribution</span>
<span class="n">vmag</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">energy</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span>
<span class="c1"># get the magnitude of the velocity from the fermi dirac distribution</span>
</pre></div>
</div>
<p>The velocity components are then initialized using a Dirichlet distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">random_numbers</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">key3</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="c1"># Generate three random numbers that sum to 1 from the dirichlet distribution for the velocity components</span>
<span class="n">v_x</span> <span class="o">=</span> <span class="n">vmag</span> <span class="o">*</span> <span class="n">random_numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">v_y</span> <span class="o">=</span> <span class="n">vmag</span> <span class="o">*</span> <span class="n">random_numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">v_z</span> <span class="o">=</span> <span class="n">vmag</span> <span class="o">*</span> <span class="n">random_numbers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># initialize the velocity components using the fermi dirac distribution and the random numbers</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyPIC3D</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="chargeconservation.html">Charge Conservation Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="yee.html">Yee Grid</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Particle Species</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-properties">Key Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#particle-species-initialization">Particle Species Initialization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#bounded-particles">Bounded Particles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#incorporating-bounded-particles-in-a-simulation">Incorporating Bounded Particles in a Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bounded-particle-initialization">Bounded Particle Initialization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lasers.html">Laser Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="materialsurfaces.html">Material Surfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Demos</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="yee.html" title="previous chapter">Yee Grid</a></li>
      <li>Next: <a href="lasers.html" title="next chapter">Laser Pulses</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/particles.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>