
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Solvers Overview &#8212; PyPIC3D 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Charge Conservation Method" href="chargeconservation.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="solvers-overview">
<h1>Solvers Overview<a class="headerlink" href="#solvers-overview" title="Permalink to this headline">¶</a></h1>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}\\\nabla \cdot \mathbf{B} = 0\\\nabla \times \mathbf{E} = -\frac{\partial \mathbf{B}}{\partial t}\\\nabla \times \mathbf{B} = \mu_0 \mathbf{J} + \mu_0 \epsilon_0 \frac{\partial \mathbf{E}}{\partial t}\end{aligned}\end{align} \]</div>
<p>PyPIC3D provides several solvers for solving the above equations, including: spectral and finite difference solvers.</p>
<section id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>The initial electric field is calculated using the following equation:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \mathbf{E} = \frac{\rho}{\epsilon_0}\]</div>
<p>PyPIC3D can solve for the initial electric field using both spectral and finite difference solvers.
The magnetic field is initialized to zero.</p>
<section id="successive-over-relaxation-sor">
<h3>Successive Over-Relaxation (SOR)<a class="headerlink" href="#successive-over-relaxation-sor" title="Permalink to this headline">¶</a></h3>
<p>The Successive Over-Relaxation (SOR) method is an iterative method used to solve linear systems of equations. The SOR method is used to solve the Poisson equation for the electric field in PyPIC3D.
The algorithm is as follows:</p>
<ol class="arabic">
<li><p>Initialize the electric potential to an array of random values.</p></li>
<li><dl>
<dt>Iterate until convergence:</dt><dd><ol class="loweralpha">
<li><p>For each grid point, update the electric potential using the formula:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\phi_{i,j,k}^{n+1} = (1 - \omega) \phi_{i,j,k}^n
+ \frac{\omega}{6} (\phi_{i+1,j,k}^{n+1} + \phi_{i-1,j,k}^{n} + \phi_{i,j+1,k}^{n+1} + \phi_{i,j-1,k}^{n} + \phi_{i,j,k+1}^{n+1} + \phi_{i,j,k-1}^{n}) - \frac{\rho_{i,j,k}}{6 \epsilon_0}\]</div>
</div></blockquote>
</li>
<li><p>Check for convergence by calculating the residual:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{residual} = \max(| \nabla^2 \phi_{i,j,k}^{n} - \frac{\rho_{i,j,k}}{\epsilon_0} |)\]</div>
</div></blockquote>
</li>
</ol>
</dd>
</dl>
</li>
</ol>
</section>
<section id="conjugate-gradient-method">
<h3>Conjugate Gradient Method<a class="headerlink" href="#conjugate-gradient-method" title="Permalink to this headline">¶</a></h3>
<p>The Conjugate Gradient Method is an iterative method used to solve linear systems of equations. The Conjugate Gradient Method is used to solve the Poisson equation for the electric field in PyPIC3D.</p>
</section>
</section>
<section id="spectral-solver">
<h2>Spectral Solver<a class="headerlink" href="#spectral-solver" title="Permalink to this headline">¶</a></h2>
<p>PyPIC3D has a explicit spectral solver that evolves the electric and magnetic fields.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\tilde{\mathbf{E}}^{n+1} = \tilde{\mathbf{E}}^n + C^2 \Delta t ( ik \times \tilde{\mathbf{B}}^n - \mu_0 \tilde{J^n} )\\\tilde{\mathbf{B}}^{n+1} = \tilde{\mathbf{B}}^n - \Delta t ( ik \times \tilde{\mathbf{E}}^{n+1} )\end{aligned}\end{align} \]</div>
</section>
<section id="finite-difference-solvers">
<h2>Finite Difference Solvers<a class="headerlink" href="#finite-difference-solvers" title="Permalink to this headline">¶</a></h2>
<p>Finite difference solvers are numerical methods that approximate derivatives by using differences between function values at discrete points.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{E}^{n+1} = \mathbf{E}^n + \Delta t \left( \nabla \times \mathbf{B}^n - \frac{\mathbf{J}^n}{\epsilon_0} \right)\\\mathbf{B}^{n+1} = \mathbf{B}^n - \Delta t \left( \nabla \times \mathbf{E}^{n+1} \right)\end{aligned}\end{align} \]</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyPIC3D</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Solvers Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spectral-solver">Spectral Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finite-difference-solvers">Finite Difference Solvers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chargeconservation.html">Charge Conservation Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="yee.html">Yee Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html">Particle Species</a></li>
<li class="toctree-l1"><a class="reference internal" href="particles.html#bounded-particles">Bounded Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="lasers.html">Laser Pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="materialsurfaces.html">Material Surfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Demos</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="chargeconservation.html" title="next chapter">Charge Conservation Method</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/solvers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>